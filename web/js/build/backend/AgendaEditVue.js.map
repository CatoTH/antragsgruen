{"version":3,"sources":["backend/AgendaEditVue.ts"],"names":["AgendaEditVue","constructor","$element","this","element","createVueWidget","vueEl","querySelector","agendaWidgetComponent","agenda","JSON","parse","getAttribute","motionTypes","saveAgendaUrl","csrf","document","widget","Vue","createApp","template","data","methods","onSaveAgenda","$","ajax","url","type","stringify","processData","contentType","dataType","headers","success","error","bootbox","alert","$refs","onSaved","catch","err","responseText","config","compilerOptions","whitespace","window","mount"],"mappings":"OAEM,MAAOA,cAIT,WAAAC,CAAYC,GACRC,KAAKC,QAAUF,EAAS,GACxBC,KAAKE,iBACT,CAEQ,eAAAA,GACJ,MAAMC,EAAQH,KAAKC,QAAQG,cAAc,eACzC,IAAIC,EAEJ,MAAMC,EAASC,KAAKC,MAAMR,KAAKC,QAAQQ,aAAa,gBAC9CC,EAAcH,KAAKC,MAAMR,KAAKC,QAAQQ,aAAa,sBACnDE,EAAgBX,KAAKC,QAAQQ,aAAa,wBAC1CG,EAAOC,SAAST,cAAc,8BAA8BK,aAAa,WAE/ET,KAAKc,OAASC,IAAIC,UAAU,CACxBC,SAAU,wTAQVC,KAAI,KACO,CACHZ,SACAI,gBAGRS,QAAS,CACL,YAAAC,GACI,MAAMN,EAASd,KAEfqB,EAAEC,KAAK,CACHC,IAAKZ,EACLa,KAAM,OACNN,KAAMX,KAAKkB,UAAUzB,KAAKM,QAC1BoB,aAAa,EACbC,YAAa,kCACbC,SAAU,OACVC,QAAS,CAAC,eAAgBjB,GAC1BkB,QAASZ,IACDA,EAAKa,MACLC,QAAQC,MAAMf,EAAKa,QAEnBjB,EAAOR,OAASY,EAChBJ,EAAOoB,MAAM,sBAAsBC,cAG5CC,MAAM,SAAUC,GACfL,QAAQC,MAAMI,EAAIC,aACtB,EACJ,KAIRtC,KAAKc,OAAOyB,OAAOC,gBAAgBC,WAAa,WAChDC,OAA4B,oBAAE1C,KAAKc,OAAQ,UAE3CT,EAAwBL,KAAKc,OAAO6B,MAAMxC,GAG1CuC,OAAqB,aAAIrC,CAC7B","file":"AgendaEditVue.js","sourcesContent":["declare let Vue: any;\n\nexport class AgendaEditVue {\n    private widget;\n    private element: HTMLElement;\n\n    constructor($element: JQuery) {\n        this.element = $element[0];\n        this.createVueWidget();\n    }\n\n    private createVueWidget() {\n        const vueEl = this.element.querySelector(\".agendaEdit\");\n        let agendaWidgetComponent;\n\n        const agenda = JSON.parse(this.element.getAttribute('data-agenda'));\n        const motionTypes = JSON.parse(this.element.getAttribute('data-motion-types'));\n        const saveAgendaUrl = this.element.getAttribute('data-save-agenda-url');\n        const csrf = document.querySelector('head meta[name=csrf-token]').getAttribute('content') as string;\n\n        this.widget = Vue.createApp({\n            template: `<div class=\"agendaEditHolder\">\n                <agenda-edit-widget\n                    v-model=\"agenda\"\n                    :motionTypes=\"motionTypes\"\n                    ref=\"agenda-edit-widget\"\n                    @saveAgenda=\"onSaveAgenda()\"\n                ></agenda-edit-widget>\n            </div>`,\n            data() {\n                return {\n                    agenda,\n                    motionTypes\n                }\n            },\n            methods: {\n                onSaveAgenda() {\n                    const widget = this;\n\n                    $.ajax({\n                        url: saveAgendaUrl,\n                        type: \"POST\",\n                        data: JSON.stringify(this.agenda),\n                        processData: false,\n                        contentType: \"application/json; charset=utf-8\",\n                        dataType: \"json\",\n                        headers: {\"X-CSRF-Token\": csrf},\n                        success: data => {\n                            if (data.error) {\n                                bootbox.alert(data.error);\n                            } else {\n                                widget.agenda = data;\n                                widget.$refs['agenda-edit-widget'].onSaved();\n                            }\n                        }\n                    }).catch(function (err) {\n                        bootbox.alert(err.responseText);\n                    })\n                }\n            }\n        });\n\n        this.widget.config.compilerOptions.whitespace = 'condense';\n        window['__initVueComponents'](this.widget, 'agenda');\n\n        agendaWidgetComponent = this.widget.mount(vueEl);\n\n        // Used by tests to control vue-select\n        window['agendaWidget'] = agendaWidgetComponent;\n    }\n}\n"]}
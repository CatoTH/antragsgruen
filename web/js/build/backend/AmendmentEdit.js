define(["require","exports","./MotionSupporterEdit","../shared/AntragsgruenEditor","../shared/AmendmentEditSinglePara","./MotionSupporterEdit"],(function(e,t,n,a,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AmendmentEdit=void 0;t.AmendmentEdit=class{constructor(){this.lang=$("html").attr("lang"),this.$updateForm=$("#amendmentUpdateForm"),this.$status=$("#amendmentStatus"),this.$editTextCaller=$("#amendmentTextEditCaller"),$("#amendmentDateCreationHolder").datetimepicker({locale:this.lang}),$("#amendmentDateResolutionHolder").datetimepicker({locale:this.lang}),$("#resolutionDateHolder").datetimepicker({locale:$("#resolutionDate").data("locale"),format:"L"}),this.$editTextCaller.find("button").on("click",this.textEditCalled.bind(this)),$(".wysiwyg-textarea .resetText").on("click",(e=>{let t=$(e.currentTarget).parents(".wysiwyg-textarea").find(".texteditor");window.CKEDITOR.instances[t.attr("id")].setData(t.data("original-html")),$(e.currentTarget).parents(".modifiedActions").addClass("hidden")})),$(".amendmentDeleteForm").on("submit",(function(e,t){if(t&&(t.confirmed,1)&&!0===t.confirmed)return;let n=$(this);e.preventDefault(),bootbox.confirm(__t("admin","delAmendmentConfirm"),(function(e){e&&n.trigger("submit",{confirmed:!0})}))})),this.initVotingFunctions(),this.initStatus(),new n.MotionSupporterEdit($("#motionSupporterHolder"))}textEditCalledMultiPara(){$(".wysiwyg-textarea").each((function(){let e=$(this).find(".texteditor"),t=new a.AntragsgruenEditor(e.attr("id")).getEditor();e.parents("form").on("submit",(function(){e.parent().find("textarea.raw").val(t.getData()),void 0!==t.plugins.lite&&(t.plugins.lite.findPlugin(t).acceptAll(),e.parent().find("textarea.consolidated").val(t.getData()))}))}))}textEditCalled(){this.$editTextCaller.addClass("hidden"),$("#amendmentTextEditHolder").removeClass("hidden"),this.$editTextCaller.data("multiple-paragraphs")?this.textEditCalledMultiPara():new d.AmendmentEditSinglePara,$("#amendmentUpdateForm").append("<input type='hidden' name='edittext' value='1'>")}initStatus(){const e=()=>{const e=parseInt(document.getElementById("amendmentStatus").value,10);32===e?(document.querySelector(".amendmentStatusString").classList.add("hidden"),document.querySelector(".amendmentStatusMotion").classList.remove("hidden"),document.querySelector(".amendmentStatusAmendment").classList.add("hidden")):22===e?(document.querySelector(".amendmentStatusString").classList.add("hidden"),document.querySelector(".amendmentStatusMotion").classList.add("hidden"),document.querySelector(".amendmentStatusAmendment").classList.remove("hidden")):(document.querySelector(".amendmentStatusString").classList.remove("hidden"),document.querySelector(".amendmentStatusMotion").classList.add("hidden"),document.querySelector(".amendmentStatusAmendment").classList.add("hidden"))};document.getElementById("amendmentStatus").addEventListener("change",e),e()}initVotingFunctions(){const e=$(".contentVotingResultCaller, .votingDataHolder"),t=$(".votingDataCloser"),n=$(".votingDataOpener"),a=$("select[name=votingBlockId]");n.on("click",(()=>{e.addClass("explicitlyOpened")})),t.on("click",(()=>{e.removeClass("explicitlyOpened")})),this.$status.on("change",(()=>{11===parseInt(this.$status.val(),10)?e.addClass("hasVotingStatus"):e.removeClass("hasVotingStatus")})).trigger("change"),$(".votingItemBlockRow select").on("change",(e=>{const t=$(e.currentTarget);if(t.val()){const e=t.find("option[value="+t.val()+"]").data("group-name");$(".votingItemBlockNameRow input").val(e),$(".votingItemBlockNameRow").removeClass("hidden")}else $(".votingItemBlockNameRow").addClass("hidden")})),a.on("change",(()=>{if("NEW"===a.val())$(".votingBlockRow .newBlock").removeClass("hidden"),$(".votingItemBlockRow").addClass("hidden"),$(".votingItemBlockNameRow").addClass("hidden");else{$(".votingBlockRow .newBlock").addClass("hidden"),$(".votingItemBlockRow").addClass("hidden");const e=$(".votingItemBlockRow"+a.val());e.removeClass("hidden"),e.length>0?(e.removeClass("hidden"),e.find("select").trigger("change")):$(".votingItemBlockNameRow").addClass("hidden")}})).trigger("change")}}}));
//# sourceMappingURL=AmendmentEdit.js.map

define(["require","exports","./MotionSupporterEdit","../shared/AntragsgruenEditor"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){var o=this,e=$("html").attr("lang");$("#motionDateCreationHolder").datetimepicker({locale:e}),$("#motionDatePublicationHolder").datetimepicker({locale:e}),$("#motionDateResolutionHolder").datetimepicker({locale:e}),$("#resolutionDateHolder").datetimepicker({locale:$("#resolutionDate").data("locale"),format:"L"}),$("#motionTextEditCaller").find("button").click(function(){o.initMotionTextEdit()}),$(".checkAmendmentCollissions").click(function(e){e.preventDefault(),o.loadAmendmentCollissions()}),$("#motionUpdateForm").submit(function(){$(".amendmentCollissionsHolder .amendmentOverrideBlock > .texteditor").each(function(){var e=CKEDITOR.instances[$(this).attr("id")].getData();$(this).parents(".amendmentOverrideBlock").find("> textarea").val(e)})}),$(".motionDeleteForm").submit(function(e,t){o.onSubmitDeleteForm(e,t)}),new i.MotionSupporterEdit($("#motionSupporterHolder"))}return e.prototype.onSubmitDeleteForm=function(e,t){t&&(t.confirmed,1)&&!0===t.confirmed||(e.preventDefault(),bootbox.confirm(__t("admin","delMotionConfirm"),function(e){e&&$(".motionDeleteForm").trigger("submit",{confirmed:!0})}))},e.prototype.initMotionTextEdit=function(){$("#motionTextEditCaller").addClass("hidden"),$("#motionTextEditHolder").removeClass("hidden"),$(".wysiwyg-textarea").each(function(){var e=$(this).find(".texteditor"),t=new n.AntragsgruenEditor(e.attr("id")).getEditor();e.parents("form").submit(function(){e.parent().find("textarea").val(t.getData())})}),$("#motionUpdateForm").append("<input type='hidden' name='edittext' value='1'>"),0<$(".checkAmendmentCollissions").length&&($(".wysiwyg-textarea .texteditor").on("focus",function(){$(".checkAmendmentCollissions").show(),$(".saveholder .save").prop("disabled",!0).hide()}),$(".checkAmendmentCollissions").show(),$(".saveholder .save").prop("disabled",!0).hide())},e.prototype.loadAmendmentCollissions=function(){var e=$(".checkAmendmentCollissions").data("url"),o={},t=$(".amendmentCollissionsHolder");$("#motionTextEditHolder").children().each(function(){var e=$(this);if(e.hasClass("wysiwyg-textarea")){var t=e.attr("id").replace("section_holder_","");o[t]=CKEDITOR.instances[e.find(".texteditor").attr("id")].getData()}}),$.post(e,{newSections:o,_csrf:$("#motionUpdateForm").find("> input[name=_csrf]").val()},function(e){t.html(e),0<t.find(".amendmentOverrideBlock > .texteditor").length&&(t.find(".amendmentOverrideBlock > .texteditor").each(function(){new n.AntragsgruenEditor($(this).attr("id"))}),$(".amendmentCollissionsHolder").scrollintoview({top_offset:-50})),$(".checkAmendmentCollissions").hide(),$(".saveholder .save").prop("disabled",!1).show()})},e}();t.MotionEdit=o});
//# sourceMappingURL=MotionEdit.js.map

define(["require","exports","./MotionSupporterEdit","../shared/AntragsgruenEditor"],function(e,t,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this,t=$("html").attr("lang");$("#motionDateCreationHolder").datetimepicker({locale:t}),$("#motionDatePublicationHolder").datetimepicker({locale:t}),$("#motionDateResolutionHolder").datetimepicker({locale:t}),$("#resolutionDateHolder").datetimepicker({locale:$("#resolutionDate").data("locale"),format:"L"}),$("#motionTextEditCaller").find("button").click(function(){e.initMotionTextEdit()}),$(".checkAmendmentCollisions").click(function(t){t.preventDefault(),e.loadAmendmentCollisions()}),$("#motionUpdateForm").submit(function(){$(".amendmentCollisionsHolder .amendmentOverrideBlock > .texteditor").each(function(){var e=CKEDITOR.instances[$(this).attr("id")].getData();$(this).parents(".amendmentOverrideBlock").find("> textarea").val(e)})}),$(".motionDeleteForm").submit(function(t,o){e.onSubmitDeleteForm(t,o)}),new o.MotionSupporterEdit($("#motionSupporterHolder"))}return e.prototype.onSubmitDeleteForm=function(e,t){t&&(t.confirmed,!0)&&!0===t.confirmed||(e.preventDefault(),bootbox.confirm(__t("admin","delMotionConfirm"),function(e){e&&$(".motionDeleteForm").trigger("submit",{confirmed:!0})}))},e.prototype.initMotionTextEdit=function(){$("#motionTextEditCaller").addClass("hidden"),$("#motionTextEditHolder").removeClass("hidden"),$(".wysiwyg-textarea").each(function(){var e=$(this).find(".texteditor"),t=new i.AntragsgruenEditor(e.attr("id")).getEditor();e.parents("form").submit(function(){e.parent().find("textarea").val(t.getData())})}),$("#motionUpdateForm").append("<input type='hidden' name='edittext' value='1'>"),$(".checkAmendmentCollisions").length>0&&($(".wysiwyg-textarea .texteditor").on("focus",function(){$(".checkAmendmentCollisions").show(),$(".saveholder .save").prop("disabled",!0).hide()}),$(".checkAmendmentCollisions").show(),$(".saveholder .save").prop("disabled",!0).hide())},e.prototype.loadAmendmentCollisions=function(){var e=$(".checkAmendmentCollisions").data("url"),t={},o=$(".amendmentCollisionsHolder");$("#motionTextEditHolder").children().each(function(){var e=$(this);if(e.hasClass("wysiwyg-textarea")){var o=e.attr("id").replace("section_holder_","");t[o]=CKEDITOR.instances[e.find(".texteditor").attr("id")].getData()}}),$.post(e,{newSections:t,_csrf:$("#motionUpdateForm").find("> input[name=_csrf]").val()},function(e){o.html(e),o.find(".amendmentOverrideBlock > .texteditor").length>0&&(o.find(".amendmentOverrideBlock > .texteditor").each(function(){new i.AntragsgruenEditor($(this).attr("id"))}),$(".amendmentCollisionsHolder").scrollintoview({top_offset:-50})),$(".checkAmendmentCollisions").hide(),$(".saveholder .save").prop("disabled",!1).show()})},e}();t.MotionEdit=n});
//# sourceMappingURL=MotionEdit.js.map

{"version":3,"sources":["backend/MotionTypeEdit.js","backend/MotionTypeEdit.ts"],"names":["define","require","exports","Object","defineProperty","value","[object Object]","$","on","removeClass","addClass","tooltip","this","initSectionList","initDeadlines","initInitiatorForm","$sameSettings","prop","trigger","$form","$initiatorGender","find","$supportType","$supportAllowMore","$initiatorCanBePerson","$initiatorCanBeOrga","currentType","parseInt","val","visibilityRules","hasInitiator","hasSupporters","toString","data","isCollectingSupporters","allowSupportAfterSubmission","is","allowFemaleQuota","filter","initiatorCanBePerson","initiatorCanBeOrga","recalcVisibilities","each","$this","motionsHaveSupporters","setMaxPdfSupporters","amendmentsHaveSupporters","ev","currentTarget","i","el","$el","datetimepicker","locale","initLinkedDeadlinePickers","$row","$from","$to","useCurrent","setErrorState","fromDate","date","toDate","isBefore","hasError","$deadlineHolder","addDeadlineRow","html","replace","$newRow","append","parents","remove","children","length","$list","newCounter","Sortable","create","handle","animation","preventDefault","$sectionHolder","first","delId","bootbox","confirm","__t","result","$li","newStr","$newObj","$tab","dataNewCounter","$ul","parent"],"mappings":"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","file":"MotionTypeEdit.js","sourcesContent":[null,"declare var Sortable;\n\nimport {AntragsgruenEditor} from \"../shared/AntragsgruenEditor\";\n\nconst CONTACT_NONE = 0;\nconst CONTACT_OPTIONAL = 1;\nconst CONTACT_REQUIRED = 2;\n\n// noinspection JSUnusedGlobalSymbols\nconst SUPPORTER_ONLY_INITIATOR = 0;\n// noinspection JSUnusedGlobalSymbols\nconst SUPPORTER_GIVEN_BY_INITIATOR = 1;\nconst SUPPORTER_COLLECTING_SUPPORTERS = 2;\nconst SUPPORTER_NO_INITIATOR = 3;\n\n// Synchronize with ISectionType\nconst TYPE_TITLE = 0;\nconst TYPE_TEXT_SIMPLE = 1;\nconst TYPE_TEXT_HTML = 2;\nconst TYPE_IMAGE = 3;\nconst TYPE_TABULAR = 4;\nconst TYPE_PDF_ATTACHMENT = 5;\nconst TYPE_PDF_ALTERNATIVE = 6;\nconst TYPE_VIDEO_EMBED = 7;\n\nclass MotionTypeEdit {\n    private motionsHaveSupporters: boolean;\n    private amendmentsHaveSupporters: boolean;\n\n    constructor() {\n        $('.deleteTypeOpener button').on('click', () => {\n            $('.deleteTypeForm').removeClass('hidden');\n            $('.deleteTypeOpener').addClass('hidden');\n        });\n\n        $('[data-toggle=\"tooltip\"]').tooltip();\n\n        this.initSectionList();\n        this.initDeadlines();\n\n        this.initInitiatorForm($(\"#motionSupportersForm\"));\n        this.initInitiatorForm($(\"#amendmentSupportersForm\"));\n\n        const $sameSettings = $(\"#sameInitiatorSettingsForAmendments input\");\n        $sameSettings.on(\"change\", () => {\n            if ($sameSettings.prop(\"checked\")) {\n                $('section.amendmentSupporters').addClass(\"hidden\");\n            } else {\n                $('section.amendmentSupporters').removeClass(\"hidden\");\n            }\n        }).trigger(\"change\");\n    }\n\n    private initInitiatorForm($form: JQuery) {\n        const $initiatorGender = $form.find(\".contactGender input\");\n\n        const $supportType = $form.find(\".supportType\");\n        const $supportAllowMore = $form.find(\".formGroupAllowMore input\");\n        const $initiatorCanBePerson = $form.find(\".contactDetails .initiatorCanBePerson input\");\n        const $initiatorCanBeOrga = $form.find(\".contactDetails .initiatorCanBeOrganization input\");\n\n        let currentType = parseInt($supportType.find('input').val() as string, 10);\n\n        const visibilityRules = {\n            hasInitiator: () => (currentType !== SUPPORTER_NO_INITIATOR),\n            hasSupporters: () => (\n                currentType !== SUPPORTER_NO_INITIATOR &&\n                $supportType.find(\"li[data-value=\\\"\" + currentType.toString(10) + \"\\\"]\").data(\"has-supporters\")\n            ),\n            isCollectingSupporters: () => (currentType === SUPPORTER_COLLECTING_SUPPORTERS),\n            allowSupportAfterSubmission: () => (\n                (currentType === SUPPORTER_COLLECTING_SUPPORTERS || currentType === SUPPORTER_GIVEN_BY_INITIATOR) &&\n                $supportAllowMore.is(':checked')\n            ),\n            allowFemaleQuota: () => (\n                currentType === SUPPORTER_COLLECTING_SUPPORTERS &&\n                parseInt($initiatorGender.filter(\":checked\").val() as string, 10) !== CONTACT_NONE\n            ),\n            initiatorCanBePerson: () => (currentType !== SUPPORTER_NO_INITIATOR && $initiatorCanBePerson.prop(\"checked\")),\n            initiatorCanBeOrga: () => (currentType !== SUPPORTER_NO_INITIATOR && $initiatorCanBeOrga.prop(\"checked\")),\n        };\n\n        const recalcVisibilities = () => {\n            $form.find(\"[data-visibility]\").each(function() {\n                const $this = $(this);\n                if (visibilityRules[$this.data('visibility')]()) {\n                    $this.removeClass('hidden');\n                } else {\n                    $this.addClass('hidden');\n                }\n            });\n        };\n\n        $supportAllowMore.on('change', () => {\n            recalcVisibilities();\n        }).trigger('change');\n\n        $supportType.on('changed.fu.selectlist', () => {\n            currentType = parseInt($supportType.find('input').val() as string, 10);\n            const hasSupporters = $supportType.find(\"li[data-value=\\\"\" + currentType.toString(10) + \"\\\"]\").data(\"has-supporters\");\n            recalcVisibilities();\n\n            this.motionsHaveSupporters = hasSupporters;\n\n            $initiatorGender.trigger('change');\n            $supportAllowMore.trigger('change');\n            this.setMaxPdfSupporters();\n        }).trigger('changed.fu.selectlist');\n\n        $initiatorCanBePerson.on(\"change\", () => {\n            if (!$initiatorCanBePerson.prop(\"checked\") && !$initiatorCanBeOrga.prop(\"checked\")) {\n                $initiatorCanBeOrga.prop(\"checked\", true).trigger(\"change\");\n            }\n            recalcVisibilities();\n        });\n        $initiatorCanBeOrga.on(\"change\", () => {\n            if (!$initiatorCanBeOrga.prop(\"checked\") && !$initiatorCanBePerson.prop(\"checked\")) {\n                $initiatorCanBePerson.prop(\"checked\", true).trigger(\"change\");\n            }\n            recalcVisibilities();\n        });\n        $initiatorGender.on(\"change\", () => {\n            recalcVisibilities();\n        }).trigger(\"change\");\n    }\n\n    private setMaxPdfSupporters() {\n        if (this.amendmentsHaveSupporters || this.motionsHaveSupporters) {\n            $('#typeMaxPdfSupportersRow').removeClass('hidden');\n        } else {\n            $('#typeMaxPdfSupportersRow').addClass('hidden');\n        }\n    }\n\n    private initDeadlines() {\n        $('#deadlineFormTypeComplex').on(\"change\", (ev) => {\n            if ($(ev.currentTarget).prop('checked')) {\n                $('.deadlineTypeSimple').addClass('hidden');\n                $('.deadlineTypeComplex').removeClass('hidden');\n            } else {\n                $('.deadlineTypeSimple').removeClass('hidden');\n                $('.deadlineTypeComplex').addClass('hidden');\n            }\n        }).trigger('change');\n\n        $('.datetimepicker').each((i, el) => {\n            const $el = $(el);\n            $el.datetimepicker({\n                locale: $el.find(\"input\").data('locale')\n            });\n        });\n\n        const initLinkedDeadlinePickers = ($row) => {\n            let $from = $row.find(\".datetimepickerFrom\"),\n                $to = $row.find(\".datetimepickerTo\");\n            $from.datetimepicker({\n                locale: $from.find(\"input\").data('locale')\n            });\n            $to.datetimepicker({\n                locale: $to.find(\"input\").data('locale'),\n                useCurrent: false\n            });\n\n            const hasError = () => {\n                const fromDate = $from.data(\"DateTimePicker\").date(),\n                    toDate = $to.data(\"DateTimePicker\").date();\n\n                return (fromDate && toDate && toDate.isBefore(fromDate));\n            };\n\n            const setErrorState = () => {\n                if (hasError()) {\n                    $from.addClass(\"has-error\");\n                    $to.addClass(\"has-error\");\n                } else {\n                    $from.removeClass(\"has-error\");\n                    $to.removeClass(\"has-error\");\n                }\n            };\n\n            $from.on(\"dp.change\", setErrorState);\n            $to.on(\"dp.change\", setErrorState);\n        };\n\n        $('.deadlineEntry').each((i, el) => {\n            initLinkedDeadlinePickers($(el));\n        });\n\n        $('.deadlineHolder').each((i, el) => {\n            const $deadlineHolder = $(el),\n                addDeadlineRow = () => {\n                    let html = $('.deadlineRowTemplate').html();\n                    html = html.replace(/TEMPLATE/g, $deadlineHolder.data('type'));\n                    let $newRow = $(html);\n                    $deadlineHolder.find('.deadlineList').append($newRow);\n                    initLinkedDeadlinePickers($newRow);\n                };\n            $deadlineHolder.find('.deadlineAdder').on(\"click\", addDeadlineRow);\n            $deadlineHolder.on('click', '.delRow', (ev) => {\n                $(ev.currentTarget).parents('.deadlineEntry').remove();\n            });\n            if ($deadlineHolder.find('.deadlineList').children().length === 0) {\n                addDeadlineRow();\n            }\n        });\n    }\n\n    private initSectionList() {\n        let $list = $('#sectionsList'),\n            newCounter = 0;\n\n        $list.data(\"sortable\", Sortable.create(<HTMLElement>$list[0], {\n            handle: '.drag-handle',\n            animation: 150\n        }));\n        $list.on('click', 'a.remover', function (ev) {\n            ev.preventDefault();\n            let $sectionHolder = $(this).parents('li').first(),\n                delId = $sectionHolder.data('id');\n            bootbox.confirm(__t('admin', 'deleteMotionSectionConfirm'), function (result) {\n                if (result) {\n                    $('.adminTypeForm').append('<input type=\"hidden\" name=\"sectionsTodelete[]\" value=\"' + delId + '\">');\n                    $sectionHolder.remove();\n                }\n            });\n        });\n        $list.on('change', '.sectionType', function () {\n            let $li = $(this).parents('li').first(),\n                val = parseInt($(this).val() as string);\n            $li.removeClass('title textHtml textSimple image tabularData pdfAlternative pdfAttachment videoEmbed');\n            if (val === TYPE_TITLE) {\n                $li.addClass('title');\n            } else if (val === TYPE_TEXT_SIMPLE) {\n                $li.addClass('textSimple');\n            } else if (val === TYPE_TEXT_HTML) {\n                $li.addClass('textHtml');\n            } else if (val === TYPE_IMAGE) {\n                $li.addClass('image');\n            } else if (val === TYPE_TABULAR) {\n                $li.addClass('tabularData');\n                if ($li.find('.tabularDataRow ul > li').length == 0) {\n                    $li.find('.tabularDataRow .addRow').trigger(\"click\").trigger(\"click\").trigger(\"click\");\n                }\n            } else if (val === TYPE_PDF_ATTACHMENT) {\n                $li.addClass('pdfAttachment');\n            } else if (val === TYPE_PDF_ALTERNATIVE) {\n                $li.addClass('pdfAlternative');\n            } else if (val === TYPE_VIDEO_EMBED) {\n                $li.addClass('videoEmbed');\n            }\n        });\n        $list.find('.sectionType').trigger('change');\n        $list.on('change', '.maxLenSet', function () {\n            let $li = $(this).parents('li').first();\n            if ($(this).prop('checked')) {\n                $li.addClass('maxLenSet').removeClass('no-maxLenSet');\n            } else {\n                $li.addClass('no-maxLenSet').removeClass('maxLenSet');\n            }\n        });\n        $list.find('.maxLenSet').trigger('change');\n\n        $('.sectionAdder').on('click', function (ev) {\n            ev.preventDefault();\n            let newStr = $('#sectionTemplate').html();\n            newStr = newStr.replace(/#NEW#/g, 'new' + newCounter);\n            let $newObj = $(newStr);\n            $list.append($newObj);\n            newCounter = newCounter + 1;\n\n            $list.find('.sectionType').trigger('change');\n            $list.find('.maxLenSet').trigger('change');\n\n            let $tab = $newObj.find('.tabularDataRow ul');\n            $tab.data(\"sortable\", Sortable.create(<HTMLElement>$tab[0], {\n                handle: '.drag-data-handle',\n                animation: 150\n            }));\n        });\n\n        let dataNewCounter = 0;\n        $list.on('click', '.tabularDataRow .addRow', function (ev) {\n            ev.preventDefault();\n            let $this = $(this),\n                $ul = $this.parent().find(\"ul\"),\n                $row = $($this.data('template').replace(/#NEWDATA#/g, 'new' + dataNewCounter));\n            dataNewCounter = dataNewCounter + 1;\n            $row.removeClass('no0').addClass('no' + $ul.children().length);\n            $ul.append($row);\n            $row.find('input').trigger('focus');\n        });\n\n        $list.on('click', '.tabularDataRow .delRow', function (ev) {\n            let $this = $(this);\n            ev.preventDefault();\n            bootbox.confirm(__t('admin', 'deleteDataConfirm'), function (result) {\n                if (result) {\n                    $this.parents(\"li\").first().remove();\n                }\n            });\n        });\n\n        $list.find('.tabularDataRow ul').each(function () {\n            let $this = $(this);\n            $this.data(\"sortable\", Sortable.create(this, {\n                handle: '.drag-data-handle',\n                animation: 150\n            }));\n        });\n    }\n}\n\n\nnew MotionTypeEdit();\n"]}
define(["require","exports","./AntragsgruenEditor"],(function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AmendmentEditSinglePara=void 0;e.AmendmentEditSinglePara=class{constructor(){this.$paragraphs=$(".wysiwyg-textarea.single-paragraph"),this.$paragraphs.on("click",(t=>{this.startEditing(t.delegateTarget)})),this.$paragraphs.find(".modifiedActions .revert").on("click",(t=>{t.preventDefault(),t.stopPropagation(),this.revertChanges(t.delegateTarget)})),this.setModifyable(),$(".wysiwyg-textarea").filter(":not(.single-paragraph)").each(((t,e)=>{this.handleRegularTextField(e)})),$(".texteditorBox").each(((t,e)=>{let a=$(e),i=a.data("section-id"),r=a.data("changed-para-no");r>-1&&$("#section_holder_"+i+"_"+r).trigger("click")}))}handleRegularTextField(t){let e=$(t),i=e.find(".texteditor");if(e.hasClass("hidden"))return;let r=new a.AntragsgruenEditor(i.attr("id")).getEditor();i.parents("form").on("submit",(()=>{i.parent().find("textarea.raw").val(r.getData()),void 0!==r.plugins.lite&&(r.plugins.lite.findPlugin(r).acceptAll(),i.parent().find("textarea.consolidated").val(r.getData()))}))}revertChanges(t){let e=$(t).parents(".wysiwyg-textarea"),a=e.find(".texteditor"),i=a.attr("id");$("#"+i).attr("contenteditable","false"),a.html(e.data("original")),e.removeClass("modified"),this.setModifyable()}startEditing(t){let e=$(t);if(!e.hasClass("modifyable"))return;e.addClass("modified"),this.setModifyable();let i,r=e.find(".texteditor");if(void 0!==CKEDITOR.instances[r.attr("id")])i=CKEDITOR.instances[r.attr("id")];else{let t=new a.AntragsgruenEditor(r.attr("id"));i=t.getEditor()}r.attr("contenteditable","true"),r.parents("form").on("submit",(()=>{r.parent().find("textarea.raw").val(i.getData()),void 0!==i.plugins.lite&&(i.plugins.lite.findPlugin(i).acceptAll(),r.parent().find("textarea.consolidated").val(i.getData()))})),r.trigger("focus")}setModifyable(){let t=this.$paragraphs.filter(".modified");0==t.length?this.$paragraphs.addClass("modifyable"):(this.$paragraphs.removeClass("modifyable"),$("input[name=modifiedParagraphNo]").val(t.data("paragraph-no")),$("input[name=modifiedSectionId]").val(t.parents(".texteditorBox").data("section-id")))}}}));
//# sourceMappingURL=AmendmentEditSinglePara.js.map

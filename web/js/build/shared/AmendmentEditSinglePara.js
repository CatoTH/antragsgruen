import{AntragsgruenEditor}from"./AntragsgruenEditor";export class AmendmentEditSinglePara{constructor(){this.$paragraphs=$(".wysiwyg-textarea.single-paragraph"),this.$paragraphs.on("click",t=>{this.startEditing(t.delegateTarget)}),this.$paragraphs.find(".modifiedActions .revert").on("click",t=>{t.preventDefault(),t.stopPropagation(),this.revertChanges(t.delegateTarget)}),this.setModifyable(),$(".wysiwyg-textarea").filter(":not(.single-paragraph)").each((t,e)=>{this.handleRegularTextField(e)}),$(".texteditorBox").each((t,e)=>{let a=$(e),i=a.data("section-id"),r=a.data("changed-para-no");r>-1&&$("#section_holder_"+i+"_"+r).trigger("click")})}handleRegularTextField(t){let e=$(t),a=e.find(".texteditor");if(e.hasClass("hidden"))return;let i=new AntragsgruenEditor(a.attr("id")).getEditor();a.parents("form").on("submit",()=>{a.parent().find("textarea.raw").val(i.getData()),void 0!==i.plugins.lite&&(i.plugins.lite.findPlugin(i).acceptAll(),a.parent().find("textarea.consolidated").val(i.getData()))})}revertChanges(t){let e=$(t).parents(".wysiwyg-textarea"),a=e.find(".texteditor"),i=a.attr("id");$("#"+i).attr("contenteditable","false"),a.html(e.data("original")),e.removeClass("modified"),this.setModifyable()}startEditing(t){let e=$(t);if(!e.hasClass("modifyable"))return;e.addClass("modified"),this.setModifyable();let a,i=e.find(".texteditor");if(void 0!==CKEDITOR.instances[i.attr("id")])a=CKEDITOR.instances[i.attr("id")];else{let t=new AntragsgruenEditor(i.attr("id"));a=t.getEditor()}i.attr("contenteditable","true"),i.parents("form").on("submit",()=>{i.parent().find("textarea.raw").val(a.getData()),void 0!==a.plugins.lite&&(a.plugins.lite.findPlugin(a).acceptAll(),i.parent().find("textarea.consolidated").val(a.getData()))}),i.trigger("focus")}setModifyable(){let t=this.$paragraphs.filter(".modified");0==t.length?this.$paragraphs.addClass("modifyable"):(this.$paragraphs.removeClass("modifyable"),$("input[name=modifiedParagraphNo]").val(t.data("paragraph-no")),$("input[name=modifiedSectionId]").val(t.parents(".texteditorBox").data("section-id")))}}
//# sourceMappingURL=AmendmentEditSinglePara.js.map

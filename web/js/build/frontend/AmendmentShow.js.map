{"version":3,"sources":["frontend/AmendmentShow.js","frontend/AmendmentShow.ts"],"names":["define","require","exports","Object","defineProperty","value","constructor","MotionInitiatorShow","$","on","this","delSubmit","bind","shareLinkClicked","ev","preventDefault","addClass","removeClass","s","location","hash","split","length","scrollintoview","top_offset","initPrivateComments","initCmdEnterSubmit","initAmendmentTextMode","form","target","bootbox","confirm","__t","result","submit","currentTarget","attr","window","open","document","originalEvent","parents","first","find","trigger","remove","$section","parent"],"mappings":"AAAAA,OAAO,CAAC,UAAW,UAAW,kCAAkC,SAAUC,EAASC,GAC/E,aACAC,OAAOC,eAAeF,EAAS,aAAc,CAAEG,OAAO,ICsF1D,IAtFA,MACIC,cACI,IAAIC,oBAEJC,EAAE,gBAAgBC,GAAG,SAAUC,KAAKC,UAAUC,KAAKF,OACnDF,EAAE,oBAAoBC,GAAG,QAASC,KAAKG,iBAAiBD,KAAKF,OAE7DF,EAAE,mBAAmBC,GAAG,SAAS,SAAUK,GACvCA,EAAGC,iBACHP,EAAEE,MAAMM,SAAS,UACjBR,EAAE,iBAAiBS,YAAY,aAGnC,IAAIC,EAAcC,SAASC,KAAKC,MAAM,SACtB,GAAZH,EAAEI,QACFd,EAAE,WAAaU,EAAE,IAAIK,eAAe,CAACC,YAAa,MAGtDd,KAAKe,sBACLf,KAAKgB,qBACLhB,KAAKiB,wBAGDhB,UAAUG,GACdA,EAAGC,iBACH,IAAIa,EAAed,EAAGe,OACtBC,QAAQC,QAAQC,IAAI,MAAO,gBAAgB,SAAUC,GAC7CA,GAEAL,EAAKM,YAKTrB,iBAAiBC,GACrB,IAAIe,EAAiBrB,EAAEM,EAAGqB,eAAeC,KAAK,QAC1CC,OAAOC,KAAKT,EAAQ,SAAU,yBAC9Bf,EAAGC,iBAIHW,qBACJlB,EAAE+B,UAAU9B,GAAG,WAAY,iBAAkBK,IACzC,GAAIA,EAAG0B,cAAuB,SAAqC,KAAhC1B,EAAG0B,cAAuB,QAAU,CACnDhC,EAAEM,EAAGqB,eACXM,QAAQ,QAAQC,QAAQC,KAAK,uBAAuBC,QAAQ,aAK1EnB,sBAEJjB,EAAE,6BAA6BC,GAAG,SAAUK,IACxCA,EAAGC,iBACHP,EAAE,sBAAsBqC,SACxBrC,EAAE,6BAA6BS,YAAY,UAC3CT,EAAE,sCAAsCoC,QAAQ,YAEpDpC,EAAE,4BAA4BC,GAAG,SAAS,KACtCD,EAAE,4BAA4BQ,SAAS,UACvCR,EAAE,sBAAsBS,YAAY,UACpCT,EAAE,0BAA0BoC,QAAQ,YAIpCjB,wBAEJnB,EAAE,gDAAgDC,GAAG,SAAUK,IAC3D,MAAMgC,EAAWtC,EAAEM,EAAGe,QAAQY,QAAQ,qBACtCK,EAASH,KAAK,+CAA+CI,SAAS/B,SAAS,YAC/E8B,EAASH,KAAK,4CAA4CI,SAAS9B,YAAY,YAC/E6B,EAASH,KAAK,mBAAmB3B,SAAS,UAC1C8B,EAASH,KAAK,oBAAoB1B,YAAY,UAC9CH,EAAGC,oBAEPP,EAAE,6CAA6CC,GAAG,SAAUK,IACxD,MAAMgC,EAAWtC,EAAEM,EAAGe,QAAQY,QAAQ,qBACtCK,EAASH,KAAK,+CAA+CI,SAAS9B,YAAY,YAClF6B,EAASH,KAAK,4CAA4CI,SAAS/B,SAAS,YAC5E8B,EAASH,KAAK,mBAAmB1B,YAAY,UAC7C6B,EAASH,KAAK,oBAAoB3B,SAAS,UAC3CF,EAAGC","file":"AmendmentShow.js","sourcesContent":[null,"import '../shared/MotionInitiatorShow';\n\nclass AmendmentShow {\n    constructor() {\n        new MotionInitiatorShow();\n\n        $(\"form.delLink\").on(\"submit\", this.delSubmit.bind(this));\n        $(\".share_buttons a\").on(\"click\", this.shareLinkClicked.bind(this));\n\n        $('.tagAdderHolder').on(\"click\", function (ev) {\n            ev.preventDefault();\n            $(this).addClass(\"hidden\");\n            $('#tagAdderForm').removeClass(\"hidden\");\n        });\n\n        let s: string[] = location.hash.split('#comm');\n        if (s.length == 2) {\n            $('#comment' + s[1]).scrollintoview({top_offset: -100});\n        }\n\n        this.initPrivateComments();\n        this.initCmdEnterSubmit();\n        this.initAmendmentTextMode();\n    }\n\n    private delSubmit(ev) {\n        ev.preventDefault();\n        let form: JQuery = ev.target;\n        bootbox.confirm(__t(\"std\", \"del_confirm\"), function (result) {\n            if (result) {\n                // noinspection JSDeprecatedSymbols\n                form.submit(); // Native submit() function, not the jQuery one\n            }\n        });\n    }\n\n    private shareLinkClicked(ev) {\n        let target: string = $(ev.currentTarget).attr(\"href\");\n        if (window.open(target, '_blank', 'width=600,height=460')) {\n            ev.preventDefault();\n        }\n    }\n\n    private initCmdEnterSubmit() {\n        $(document).on('keypress', 'form textarea', (ev) => {\n            if (ev.originalEvent['metaKey'] && ev.originalEvent['keyCode'] === 13) {\n                let $textarea = $(ev.currentTarget);\n                $textarea.parents(\"form\").first().find(\"button[type=submit]\").trigger(\"click\");\n            }\n        });\n    }\n\n    private initPrivateComments()\n    {\n        $('.privateNoteOpener button').on(\"click\", (ev) => {\n            ev.preventDefault();\n            $('.privateNoteOpener').remove();\n            $('.motionData .privateNotes').removeClass('hidden');\n            $('.motionData .privateNotes textarea').trigger(\"focus\");\n        });\n        $('.privateNotes blockquote').on(\"click\", () => {\n            $('.privateNotes blockquote').addClass('hidden');\n            $('.privateNotes form').removeClass('hidden');\n            $('.privateNotes textarea').trigger(\"focus\");\n        });\n    }\n\n    private initAmendmentTextMode()\n    {\n        $('.amendmentTextModeSelector a.showOnlyChanges').on('click', (ev) => {\n            const $section = $(ev.target).parents(\".motionTextHolder\");\n            $section.find(\".amendmentTextModeSelector .showOnlyChanges\").parent().addClass('selected');\n            $section.find(\".amendmentTextModeSelector .showFullText\").parent().removeClass('selected');\n            $section.find(\".fullMotionText\").addClass('hidden');\n            $section.find(\".onlyChangedText\").removeClass('hidden');\n            ev.preventDefault();\n        });\n        $('.amendmentTextModeSelector a.showFullText').on('click', (ev) => {\n            const $section = $(ev.target).parents(\".motionTextHolder\");\n            $section.find(\".amendmentTextModeSelector .showOnlyChanges\").parent().removeClass('selected');\n            $section.find(\".amendmentTextModeSelector .showFullText\").parent().addClass('selected');\n            $section.find(\".fullMotionText\").removeClass('hidden');\n            $section.find(\".onlyChangedText\").addClass('hidden');\n            ev.preventDefault();\n        });\n    }\n}\n\nnew AmendmentShow();\n"]}
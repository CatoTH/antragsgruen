define(["require","exports"],(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MotionMergeAmendmentsPublic=void 0;e.MotionMergeAmendmentsPublic=class{constructor(t){this.$widget=t,this.interval=null,this.initUpdateWidget()}showUpdated(){let t=this.$updateWidget.find(".updated");t.addClass("active"),window.setTimeout((()=>{t.removeClass("active")}),2e3)}setContentEvents(){this.$draftContent.find(".appendHint").each(((t,e)=>{let i=$(e),a=i.data("amendment-id");void 0===a&&(i=i.parents("[data-amendment-id]").first(),a=i.data("amendment-id")),a&&(i.addClass("amendmentAjaxTooltip"),i.data("initialized","0"),i.data("url",i.data("link")+"/ajax-diff"),i.data("placement","bottom"))}))}reload(t){$.get(this.updateUrl,(e=>{e.success?(this.$dateField.text(e.date),this.$draftContent.html(e.html),this.setContentEvents(),t&&this.showUpdated()):alert(e.error)}))}startInterval(){null===this.interval&&(this.interval=window.setInterval(this.reload.bind(this,!1),5e3))}stopInterval(){null!==this.interval&&(window.clearInterval(this.interval),this.interval=null)}initUpdateWidget(){this.$updateWidget=this.$widget.find(".motionUpdateWidget"),this.$draftContent=this.$widget.find(".draftContent"),this.$dateField=this.$widget.find(".mergeDraftDate"),this.updateUrl=this.$widget.data("reload-url"),this.setContentEvents();let t=this.$updateWidget.find("#autoUpdateToggle");if(localStorage){let e=localStorage.getItem("merging-draft-auto-update");null!==e&&t.prop("checked","1"==e)}t.on("change",(()=>{let e=t.prop("checked");localStorage&&localStorage.setItem("merging-draft-auto-update",e?"1":"0"),e?this.startInterval():this.stopInterval()})).trigger("change"),this.$updateWidget.find("#updateBtn").on("click",this.reload.bind(this,!0))}}}));
//# sourceMappingURL=MotionMergeAmendmentsPublic.js.map

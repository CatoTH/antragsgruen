export class MotionMergeAmendmentsPublic{constructor(t){this.$widget=t,this.interval=null,this.initUpdateWidget()}showUpdated(){let t=this.$updateWidget.find(".updated");t.addClass("active"),window.setTimeout(()=>{t.removeClass("active")},2e3)}setContentEvents(){this.$draftContent.find(".appendHint").each((t,e)=>{let a=$(e),i=a.data("amendment-id");void 0===i&&(a=a.parents("[data-amendment-id]").first(),i=a.data("amendment-id")),i&&(a.addClass("amendmentAjaxTooltip"),a.data("initialized","0"),a.data("url",a.data("link")+"/ajax-diff"),a.data("placement","bottom"))})}reload(t){$.get(this.updateUrl,e=>{e.success?(this.$dateField.text(e.date),this.$draftContent.html(e.html),this.setContentEvents(),t&&this.showUpdated()):alert(e.error)})}startInterval(){null===this.interval&&(this.interval=window.setInterval(this.reload.bind(this,!1),5e3))}stopInterval(){null!==this.interval&&(window.clearInterval(this.interval),this.interval=null)}initUpdateWidget(){this.$updateWidget=this.$widget.find(".motionUpdateWidget"),this.$draftContent=this.$widget.find(".draftContent"),this.$dateField=this.$widget.find(".mergeDraftDate"),this.updateUrl=this.$widget.data("reload-url"),this.setContentEvents();let t=this.$updateWidget.find("#autoUpdateToggle");if(localStorage){let e=localStorage.getItem("merging-draft-auto-update");null!==e&&t.prop("checked","1"==e)}t.on("change",()=>{let e=t.prop("checked");localStorage&&localStorage.setItem("merging-draft-auto-update",e?"1":"0"),e?this.startInterval():this.stopInterval()}).trigger("change"),this.$updateWidget.find("#updateBtn").on("click",this.reload.bind(this,!0))}}
//# sourceMappingURL=MotionMergeAmendmentsPublic.js.map

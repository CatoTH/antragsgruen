{"version":3,"sources":["frontend/EditorialEdit.js","frontend/EditorialEdit.ts"],"names":["__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","define","require","exports","AntragsgruenEditor_1","Object","defineProperty","EditorialEdit","constructor","$form","on","preventDefault","$saveRow","find","$textHolder","$editCaller","editCalled","bind","addClass","save","ev","attr","editor","AntragsgruenEditor","trigger","removeClass","data","getEditor","getData","_csrf","val","$","post","ret","window","setTimeout","destroy","html","alert"],"mappings":"AAAA,IAAIA,UAAaC,MAAQA,KAAKD,WAAc,SAAUE,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,GAAS,CAAE,MAAOG,GAAKL,EAAOK,EAAI,CAAE,CAC1F,SAASC,EAASJ,GAAS,IAAMC,EAAKN,EAAiB,MAAEK,GAAS,CAAE,MAAOG,GAAKL,EAAOK,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAeL,EAIaK,EAAOC,KAAOT,EAAQQ,EAAOL,QAJ1CA,EAIyDK,EAAOL,MAJhDA,aAAiBN,EAAIM,EAAQ,IAAIN,GAAE,SAAUG,GAAWA,EAAQG,EAAQ,KAIjBO,KAAKR,EAAWK,EAAW,CAC7GH,GAAMN,EAAYA,EAAUa,MAAMhB,EAASC,GAAc,KAAKS,OAClE,GACJ,EACAO,OAAO,CAAC,UAAW,UAAW,iCAAiC,SAAUC,EAASC,EAASC,GACvF,aACAC,OAAOC,eAAeH,EAAS,aAAc,CAAEX,OAAO,IACtDW,EAAQI,mBAAgB,ECV5BJ,EAAAI,cAAA,MAMI,WAAAC,CAAoBC,GAAA1B,KAAA0B,MAAAA,EAChBA,EAAMC,GAAG,UAAUf,GAAKA,EAAEgB,mBAC1B5B,KAAK6B,SAAW7B,KAAK0B,MAAMI,KAAK,YAChC9B,KAAK+B,YAAc/B,KAAK0B,MAAMI,KAAK,eACnC9B,KAAKgC,YAAchC,KAAK0B,MAAMI,KAAK,eAEnC9B,KAAKgC,YAAYL,GAAG,QAAS3B,KAAKiC,WAAWC,KAAKlC,OAClDA,KAAK6B,SAASM,SAAS,UACvBnC,KAAK6B,SAASC,KAAK,UAAUH,GAAG,QAAS3B,KAAKoC,KAAKF,KAAKlC,MAC5D,CAEQ,UAAAiC,CAAWI,GACfA,EAAGT,iBACH5B,KAAKgC,YAAYG,SAAS,UAC1BnC,KAAK+B,YAAYO,KAAK,kBAAmB,QAEzCtC,KAAKuC,OAAS,IAAIlB,EAAAmB,mBAAmBxC,KAAK+B,YAAYO,KAAK,OAE3DtC,KAAK+B,YAAYU,QAAQ,SACzBzC,KAAK6B,SAASa,YAAY,SAC9B,CAEc,IAAAN,CAAKC,GDGX,OAAOtC,UAAUC,UAAM,OAAQ,GAAQ,YCF3CqC,EAAGT,iBACH,IAAIe,EAAO,CACPA,KAAQ3C,KAAKuC,OAAOK,YAAYC,UAChCC,MAAS9C,KAAK0B,MAAMI,KAAK,uBAAuBiB,OAGpDC,EAAEC,KAAKjD,KAAK0B,MAAMY,KAAK,UAAWK,GAAOO,IACjCA,EAAa,SACbC,OAAOC,YAAW,KACdpD,KAAKuC,OAAOK,YAAYS,SAAS,GAClC,KACHrD,KAAK6B,SAASM,SAAS,UACvBnC,KAAK+B,YAAYO,KAAK,kBAAmB,SACzCtC,KAAKgC,YAAYU,YAAY,UAE7B1C,KAAK+B,YAAYuB,KAAKJ,EAAU,OAEhCK,MAAM,0BACV,GAER,GDGI,EAGR","file":"EditorialEdit.js","sourcesContent":[null,"import { AntragsgruenEditor } from '../shared/AntragsgruenEditor';\n\nexport class EditorialEdit {\n    private $editCaller: JQuery;\n    private $textHolder: JQuery;\n    private $saveRow: JQuery;\n    private editor: AntragsgruenEditor;\n\n    constructor(private $form: JQuery) {\n        $form.on(\"submit\", e => e.preventDefault()); // necessary for IE11\n        this.$saveRow = this.$form.find('.saveRow');\n        this.$textHolder = this.$form.find('.textHolder');\n        this.$editCaller = this.$form.find('.editCaller');\n\n        this.$editCaller.on(\"click\", this.editCalled.bind(this));\n        this.$saveRow.addClass('hidden');\n        this.$saveRow.find('button').on(\"click\", this.save.bind(this));\n    }\n\n    private editCalled(ev) {\n        ev.preventDefault();\n        this.$editCaller.addClass('hidden');\n        this.$textHolder.attr('contenteditable', \"true\");\n\n        this.editor = new AntragsgruenEditor(this.$textHolder.attr(\"id\"));\n\n        this.$textHolder.trigger(\"focus\");\n        this.$saveRow.removeClass('hidden');\n    }\n\n    private async save(ev) {\n        ev.preventDefault();\n        let data = {\n            'data': this.editor.getEditor().getData(),\n            '_csrf': this.$form.find('> input[name=_csrf]').val()\n        };\n\n        $.post(this.$form.attr('action'), data, (ret) => {\n            if (ret['success']) {\n                window.setTimeout(() => {\n                    this.editor.getEditor().destroy();\n                }, 100);\n                this.$saveRow.addClass('hidden');\n                this.$textHolder.attr('contenteditable', 'false');\n                this.$editCaller.removeClass('hidden');\n\n                this.$textHolder.html(ret['html']);\n            } else {\n                alert('Something went wrong...');\n            }\n        })\n    }\n}\n"]}
{"version":3,"sources":["frontend/ProposedProcedureOverview.js","frontend/ProposedProcedureOverview.ts"],"names":["define","require","exports","Object","defineProperty","value","ProposedProcedureOverview","constructor","$widget","this","interval","initUpdateWidget","reload","$","get","updateUrl","data","success","$dateField","text","date","$proposalList","html","error","alert","startInterval","window","setInterval","bind","stopInterval","clearInterval","$updateWidget","find","$toggle","on","prop","trigger"],"mappings":"AAAAA,OAAO,CAAC,UAAW,YAAY,SAAUC,EAASC,GAC9C,aACAC,OAAOC,eAAeF,EAAS,aAAc,CAAEG,OAAO,IACtDH,EAAQI,+BAA4B,ECIxCJ,EAAAI,0BAAA,MAOI,WAAAC,CAAmBC,GAAAC,KAAAD,QAAAA,EAFXC,KAAAC,SAAmB,KAGvBD,KAAKE,kBACT,CAEQ,MAAAC,GACJC,EAAEC,IAAIL,KAAKM,WAAYC,IACdA,EAAKC,SAMVR,KAAKS,WAAWC,KAAKH,EAAKI,MAC1BX,KAAKY,cAAcC,KAAKN,EAAKM,OANrBN,EAAKO,OACLC,MAAMR,EAAKO,MAKe,GAE1C,CAEQ,aAAAE,GACkB,OAAlBhB,KAAKC,WAGTD,KAAKC,SAAWgB,OAAOC,YAAYlB,KAAKG,OAAOgB,KAAKnB,MAAO,KAC/D,CAEQ,YAAAoB,GACkB,OAAlBpB,KAAKC,WAGTgB,OAAOI,cAAcrB,KAAKC,UAC1BD,KAAKC,SAAW,KACpB,CAEQ,gBAAAC,GACJF,KAAKsB,cAAgBtB,KAAKD,QAAQwB,KAAK,qBACvCvB,KAAKY,cAAgBZ,KAAKD,QAAQwB,KAAK,kBACvCvB,KAAKS,WAAaT,KAAKD,QAAQwB,KAAK,sBACpCvB,KAAKM,UAAYN,KAAKD,QAAQQ,KAAK,cAEnC,IAAIiB,EAAUxB,KAAKsB,cAAcC,KAAK,qBACtCC,EAAQC,GAAG,UAAU,KACKD,EAAQE,KAAK,YAE/B1B,KAAKG,SACLH,KAAKgB,iBAELhB,KAAKoB,cACT,IACDO,QAAQ,SACf,EDRJ","file":"ProposedProcedureOverview.js","sourcesContent":[null,"interface ReloadResult {\n    success: boolean;\n    error?: string;\n    html?: string;\n    date?: string;\n}\n\nexport class ProposedProcedureOverview {\n    private $updateWidget: JQuery;\n    private updateUrl: string;\n    private $proposalList: JQuery;\n    private $dateField: JQuery;\n    private interval: number = null;\n\n    constructor(public $widget: JQuery) {\n        this.initUpdateWidget();\n    }\n\n    private reload() {\n        $.get(this.updateUrl, (data: ReloadResult) => {\n            if (!data.success) {\n                if (data.error) {\n                    alert(data.error);\n                }\n                return;\n            }\n            this.$dateField.text(data.date);\n            this.$proposalList.html(data.html);\n        });\n    }\n\n    private startInterval() {\n        if (this.interval !== null) {\n            return;\n        }\n        this.interval = window.setInterval(this.reload.bind(this), 10000);\n    }\n\n    private stopInterval() {\n        if (this.interval === null) {\n            return;\n        }\n        window.clearInterval(this.interval);\n        this.interval = null;\n    }\n\n    private initUpdateWidget() {\n        this.$updateWidget = this.$widget.find('.autoUpdateWidget');\n        this.$proposalList = this.$widget.find('.reloadContent');\n        this.$dateField = this.$widget.find('.currentDate .date');\n        this.updateUrl = this.$widget.data('reload-url');\n\n        let $toggle = this.$updateWidget.find('#autoUpdateToggle');\n        $toggle.on(\"change\", () => {\n            let active: boolean = $toggle.prop('checked');\n            if (active) {\n                this.reload();\n                this.startInterval();\n            } else {\n                this.stopInterval();\n            }\n        }).trigger('change');\n    }\n}\n"]}